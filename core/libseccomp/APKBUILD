pkgname=libseccomp
pkgver=2.4.3
pkgrel=0
pkgdesc="An interface to the Linux Kernel's syscall filtering mechanism"
url="https://github.com/seccomp/libseccomp"
arch="all"
license="LGPL-2.1"
depends_dev="linux-dev"
makedepends="$depends_dev"
checkdepends="bash"
subpackages="$pkgname-dev $pkgname-doc"
source="https://github.com/seccomp/libseccomp/releases/download/v$pkgver/libseccomp-$pkgver.tar.gz
	remove-redefinition-prctl.patch
	tests-rely-on-__SNR_xxx-instead-of-__NR_xxx-for-syscalls.patch
	"

build() {
	cd "$builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--infodir=/usr/share/info \
		--localstatedir=/var
	make
}

check() {
	cd "$builddir"
	make check
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" install
}

b2sums="272c9f1ca7e4059790f633a79cae8612831aa483d28630fb85b31dc2be0192907a8897819d835b61324e0b3fb0d77b8781e2a85e9750ef8d7974d8680b8cdea3  libseccomp-2.4.3.tar.gz
59101d415f2c2b2742d38ecaccb94c9e03f13517795e5ba8420bf5dd35491cd3746e6e1a624f39cba2e415598e4d9c33f24ba6f0fd201cbafef314f0b7fb9ab5  remove-redefinition-prctl.patch
bfee9a90c8c4336404a8ab7a706c80862a5a90fdf3952864ca2773d602c46981d7c1763d8f619cbd16f58be6b0c1eda43869b9be7f42437cfd097a716594981a  tests-rely-on-__SNR_xxx-instead-of-__NR_xxx-for-syscalls.patch"
