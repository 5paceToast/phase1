pkgname=fakeroot
pkgver=0.18
pkgrel=0
pkgdesc="Gives a fake root environment, useful for building packages as a non-privileged user"
arch="all"
license="GPL-3.0-or-later"
url="https://packages.debian.org/fakeroot"
depends=acl
options="!checkroot"
checkdepends="bash"
depends="libacl libattr"
makedepends_build="libtool autoconf automake po4a acl-dev attr-dev"
makedepends_host="libcap-dev acl-dev linux-headers attr-dev"
makedepends="$makedepends_build $makedepends_host"
subpackages="$pkgname-doc"
source="https://downloads.sourceforge.net/project/fakerootng/fakeroot-ng/fakeroot-ng-0.18.tar.gz"
builddir="$srcdir"/$pkgname-ng-$pkgver

check() {
	cd "$builddir"
	return 0
	make check
}

build() {
	cd "$builddir"

	if [ "$CLIBC" = "musl" ]; then
		# musl does not have _STAT_VER, it's really not used for
		# anything, so define it as zero (just like uclibc does)
		export CFLAGS="-D_STAT_VER=0 $CFLAGS"
	fi

	CC=$CC CXX=$CXX ./bootstrap
	CC=$CC CXX=$CXX ./configure \
		--prefix=/usr \
		--sbindir=/usr/bin

	make
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" install
}

sha512sums="8ece6830d229b92537d9c0a2eb42cb9ec4ae6b83453303004dded5eab0707b9ae8eaa2c71aac6ea68226c43cf08db6b0939a9422aab32948f5ecb185ee01d854  fakeroot-ng-0.18.tar.gz"
